<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Canvas</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
    <center>
        <canvas
            id="myCanvas" width="800" height="800" style="border:1px solid #000000;">  
        </canvas>
       <br>
        <p id="printResultsField"></p>
        <br>
        <script>
//=============================================================        
            var w, h;
            var step = 200;
            var canvas = document.getElementById("myCanvas");
            var ctx = canvas.getContext("2d");
            w = canvas.width;
            h = canvas.height;
            ctx.font = "30px Arial";
            ctx.fillText("Hello Plot", 10, 50);
            //document.getElementById("printResultsField").innerHTML ;
           drawGrid(ctx, w, h, step);
            var xmlhttp = new XMLHttpRequest();
           xmlhttp.onreadystatechange = function () {
                if (this.readyState === 4 && this.status === 200) {
                    var myObj = JSON.parse(this.responseText);
                    drawPlot(myObj["plot"]);
                }
            }
           xmlhttp.open("GET", "http://192.168.0.106:8080/MonteWeb/ChartServlet", true);
           xmlhttp.send();

//==============================================================

function drawPlot(plot) {
                const {width, height} = canvas.getBoundingClientRect();
                //ctx.clearRect(0, 0, width, height);
                scaleX = width / (plot.maxX - plot.minX);
                scaleY = height / (plot.maxY - plot.minY);
                points = plot["points"];
                ctx.beginPath();
                ctx.moveTo(points[0]["x"] * scaleX, 400 - points[0]["y"] * scaleY);
                var i;
                for (i = 0; i < points.length; i++) {
                    var p = points[i];
                    ctx.lineTo((p["x"] - plot.minX) * scaleX, (plot.maxY - p["y"]) * scaleY);
                }
                ctx.closePath();
                ctx.stroke();
            }

            
function drawGrid (ctx, w, h, step) {
    
            ctx.lineWidth = 1;
            ctx.strokeStyle = 'rgb(20, 20, 20)';//color 
           ctx.beginPath();
            
            for (var x = 0; x <= w; x += step) {
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, h);
                }
                
                 for (var y = 0; y <= h; y += step) {
                  ctx.moveTo(0, y);
                    ctx.lineTo(w, y);
                }
                
              ctx.closePath();
              ctx.stroke();
            }
            
            function increase(){
               ctx.clearRect(0, 0, w, h);
                step++;
                drawGrid(ctx, w, h, step);
            }
            
            function decrease(){
                ctx.clearRect(0, 0, w, h);
                step--;
             drawGrid(ctx, w, h, step);
             }
            
        </script>

        <button type="button" onclick="alert('!!! Btn is under construction!!!')">Scale</button>
        <button type="button" onclick="increase()">Grid step +</button>
        <button type="button" onclick="decrease()">Grid step -</button>
    </center>
</body>
</html>
